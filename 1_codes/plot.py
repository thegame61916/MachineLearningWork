import matplotlib.pyplot as plt
import numpy as np

def make_plot(data_x, data_y,xlabel, ylabel, legends, plotno, title):
	plt.plot(data_x, data_y)
	plt.title(title)
	plt.ylabel(ylabel)
	plt.xlabel(xlabel)
	#plt.ylim(0,0.7)
	plt.legend(legends, loc='upper left')
	plt.show()

def make_plot2(data_x, data_y1, data_y2, xlabel, ylabel, legends, plotno, title):
	plt.plot(data_x, data_y1)
	plt.plot(data_x, data_y2)
	plt.title(title)
	plt.ylabel(ylabel)
	plt.xlabel(xlabel)
	#plt.ylim(0,0.7)
	plt.legend(legends, loc='upper left')
	plt.show()


################################################################################
# Lab1
################################################################################

#Batch-Size
bs = [16, 25, 32, 40, 50, 64, 70, 75 , 80 , 128, 256, 512, 1024]
loss = [0.25245562518707049, 0.22899050188987222, 0.20012968482977728, 0.21860087369562481, 0.17129996617683302, 0.15092742035321183, 0.17201361396691039, 0.13911427500199758, 0.16101911692847937, 0.15517753998602762, 0.12994232358069766, 0.097423025143614242, 0.078485892806754151]
acc = [0.97919999999999996, 0.98029999999999995, 0.98019999999999996, 0.97950000000000004, 0.98170000000000002, 0.9839, 0.98180000000000001, 0.98340000000000005, 0.98170000000000002, 0.98140000000000005, 0.98299999999999998, 0.98370000000000002, 0.9839]
make_plot(bs, loss, "Batch Size", "Loss", ["Test"], 1, "Batch-Size Plot")
make_plot(bs, acc, "Batch Size", "Accuracy", ["Test"], 1, "Batch-Size Plot")

#Hidden Layer
bs = [16, 25, 32, 40, 50, 64, 70, 75 , 80 , 128, 256, 512, 1024, 2048]
loss = [0.18847348423413932, 0.14699690231066198, 0.13036677925344556, 0.1100949567000498, 0.11222183221429587, 0.086580080546485264, 0.082576323416433298, 0.11358503327257931, 0.086521777197928168, 0.092644556526665103, 0.11862067084907235, 0.10295464527717188, 0.1241343906752171, 0.11449625944050738]
acc = [0.94340000000000002, 0.95579999999999998, 0.9627, 0.96740000000000004, 0.96499999999999997, 0.97460000000000002, 0.9758, 0.96799999999999997, 0.97529999999999994, 0.97719999999999996, 0.97809999999999997, 0.98309999999999997, 0.98319999999999996, 0.98550000000000004]
make_plot(bs, loss, "Hidden layer size", "Loss", ["Test"], 1, "Hidden Layer Plot")
make_plot(bs, acc, "Hidden layer size", "Accuracy", ["Test"], 1, "Hidden Layer Plot")

#Activations
#bs = ['relu','sigmoid','tanh']
#test loss:  [nan, 0.12632885336975214, 8.3781861152648922]
#accuray:  [0.97729999999999995, 0.97729999999999995, 0.086699999999999999]
#make_plot(bs, loss, "activation function", "Loss", ["Test"], 1, "Activation Plot")
#make_plot(bs, acc, "activation function", "Accuracy", ["Test"], 1, "Activation Plot")




#########################################################################################
#Lab 2
#########################################################################################
#Flipping
bs = [1,2,3,4,5,6,7,8,9,10]
acc = [0.31758000055700542, 0.44281999908387659, 0.49159999898076057, 0.52704000023007391, 0.55072000101208685, 0.56916000214219098, 0.58810000351071356, 0.59856000351905825, 0.61078000333905225, 0.62324000391364098]
val_acc = [0.41280000023543834, 0.47209999978542327, 0.51120000064373017, 0.53910000011324888, 0.54240000128746035, 0.56620000109076496, 0.58190000057220459, 0.57810000300407405, 0.60170000255107881, 0.60210000187158585]
loss = [1.8812522939443588, 1.543855159521103, 1.4198439015150071, 1.3365210299491883, 1.2695843603610992, 1.216543313920498, 1.1736813672184945, 1.1366994103193284, 1.105274732351303, 1.0725968163609505]
val_loss = [1.6146261262893677, 1.4848032575845718, 1.363097739815712, 1.2979066747426986, 1.3057943034172057, 1.2224134427309037, 1.1885343295335771, 1.1931746664643288, 1.1407240840792656, 1.1329013815522193]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "Flipping images")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "Flipping images")

#Rotation
bs = [1,2,3,4,5,6,7,8,9,10]
acc = [0.33674000015109778, 0.44527999904751775, 0.48515999910235402, 0.51619999921321869, 0.5411399992704391, 0.56056000116467475, 0.58086000236868862, 0.593040001988411, 0.60850000393390657, 0.61700000351667406]
val_acc = [0.42049999929964543, 0.46359999939799307, 0.49179999813437464, 0.52399999856948853, 0.54790000349283219, 0.57070000261068343, 0.52570000097155567, 0.58360000416636471, 0.59339999929070475, 0.59870000466704365]
loss = [1.8270206836462022, 1.5316689199209212, 1.4267592609524726, 1.3514379854798317, 1.2874963638186454, 1.2337282826304437, 1.1827829938530923, 1.1458562284708023, 1.1093988683223723, 1.0800122876167297]
val_loss = [1.607163554430008, 1.490283670425415, 1.4235108917951584, 1.3417446023225785, 1.2757143378257751, 1.2071633806824684, 1.3515455603599549, 1.161034725010395, 1.1544454607367516, 1.1448421332240104]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "Rotating images")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "Rotating images")

#Shift
bs = [1,2,3,4,5,6,7,8,9,10]
acc = [0.32168000024929644, 0.43769999864697456, 0.49075999879837034, 0.52034000006318093, 0.54514000105857852, 0.5651600018441677, 0.58048000288009649, 0.59404000285267833, 0.60650000315904617, 0.61768000376224519]
val_acc = [0.39510000027716158, 0.47409999862313268, 0.49780000001192093, 0.52409999847412114, 0.54910000160336492, 0.55930000111460687, 0.57150000303983683, 0.57770000413060185, 0.59070000499486919, 0.58960000097751619]
loss = [1.8639719310998917, 1.5498733454942704, 1.4201333556175233, 1.3361469576358795, 1.272888668358326, 1.2246793329715728, 1.1864442623257636, 1.1480655304193497, 1.1175299137830734, 1.0882603368759156]
val_loss = [1.6385362607240677, 1.4560435098409652, 1.4097874015569687, 1.3374823975563048, 1.2570987385511398, 1.2434246268868447, 1.2099984323978423, 1.1956293287873268, 1.1455706468224525, 1.1671904140710831]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "Shifting images")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "Shifting images")

# ZCA Whitening
bs = [1,2,3,4,5,6,7,8,9,10]
[0.32494000003859402, 0.44961999917030332, 0.49407999947667119, 0.5199799997806549, 0.54093999961018557, 0.56320000156760219, 0.57804000204801564, 0.59072000291943549, 0.60008000293374064, 0.6144000032246113]
val_acc = [0.41979999944567681, 0.47459999904036521, 0.49819999888539312, 0.53279999941587453, 0.54000000014901162, 0.56070000171661372, 0.56980000182986257, 0.58790000200271608, 0.59250000104308131, 0.59940000236034396]
loss = [1.8572975177764892, 1.5194766069650649, 1.4121729228496551, 1.3415263215899467, 1.2866891070604325, 1.2352984691858291, 1.1964307934045793, 1.1640426316261292, 1.1313579197525978, 1.1053265835642814]
val_loss = [1.6108195519447326, 1.4508429437875747, 1.3807624721527099, 1.3035646307468414, 1.2900690785050393, 1.224878959953785, 1.2155916041135788, 1.1673161831498147, 1.153516891002655, 1.1366218364238738]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "ZCA Whitening")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "ZCA Whitening")

#RGB to Grey Scale
bs = [1,2,3,4,5,6,7,8,9,10]
acc = [0.24586000054702162, 0.36558000069856644, 0.42021999959647655, 0.45097999893128871, 0.48171999931335452, 0.50621999943256379, 0.52554000014066693, 0.5410200001597405, 0.55668000194430356, 0.56870000284910205]
val_acc = [0.26029999915510416, 0.31510000094771384, 0.34210000127553941, 0.3830000006407499, 0.39820000052452087, 0.38950000055134298, 0.40479999929666521, 0.43399999983608722, 0.4235999997705221, 0.44849999852478506]
loss = [2.0639836107492449, 1.751922357559204, 1.6253272575139999, 1.5437158039808274, 1.4733572070598602, 1.4133189862966538, 1.3598462117314338, 1.3162066065073013, 1.2729998924136161, 1.2357709606289864]
val_loss = [2.1852927488088607, 2.0811213612556458, 2.1102492940425872, 1.8851368600130081, 1.8723188638687134, 1.9694615203142165, 1.9237307459115982, 1.806199100613594, 1.8626618224382401, 1.7511376368999481]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "RGB to Grey Scale")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "RGB to Grey Scale")

#Normal
bs = [1,2,3,4,5,6,7,8,9,10]
acc= [0.31758000055700542, 0.44281999908387659, 0.49159999898076057, 0.52704000023007391, 0.55072000101208685, 0.56916000214219098, 0.58810000351071356, 0.59856000351905825, 0.61078000333905225, 0.62324000391364098]
val_acc= [0.41280000023543834, 0.47209999978542327, 0.51120000064373017, 0.53910000011324888, 0.54240000128746035, 0.56620000109076496, 0.58190000057220459, 0.57810000300407405, 0.60170000255107881, 0.60210000187158585]
loss= [1.8812522939443588, 1.543855159521103, 1.4198439015150071, 1.3365210299491883, 1.2695843603610992, 1.216543313920498, 1.1736813672184945, 1.1366994103193284, 1.105274732351303, 1.0725968163609505]
val_loss= [1.6146261262893677, 1.4848032575845718, 1.363097739815712, 1.2979066747426986, 1.3057943034172057, 1.2224134427309037, 1.1885343295335771, 1.1931746664643288, 1.1407240840792656, 1.1329013815522193]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "Without modification")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "Without modification")



##################################################################################################################################
#Learning Rate
##################################################################################################################################
x = [0.001, 0.003, 0.005, 0.007, 0.01, 0.03, 0.05, 0.07, 0.1, 0.3, 0.5, 0.7, 1, 2, 3]
loss = [1.14341122952, 1.17117136745, 1.15135177402, 1.13536385098, 1.159227771, 1.16353949852, 1.16622886944, 1.10459586811, 1.14742383537, 1.15523281155, 1.14575729609, 1.20554037666, 1.1738930212, 1.16696104918, 1.16223934364]
acc = [0.5985, 0.5882, 0.6002, 0.6039, 0.5975, 0.5937, 0.5954, 0.61, 0.5932, 0.5965, 0.5908, 0.5869, 0.5866, 0.593, 0.5875]
#make_plot(bs, loss, "Learning Rate", "Loss", ["Test"], 1, "Learning rate Plot")
make_plot(bs, acc, "Leaning Rate", "Accuracy", ["Test"], 1, "Learning rate Plot")


##################################################################################################################################
#Batch Size
##################################################################################################################################
x = [1, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150]
loss = [1.66540911064, 1.13044199619, 1.19698039818, 1.15579410114, 1.27962274418, 1.21708079109, 1.19595346565, 1.25668922348, 1.28319843025, 1.40988299522, 1.27138729811, 1.31355451393, 1.37894619598, 1.3695682333]
acc = [0.4242, 0.6053, 0.576, 0.5978, 0.5451, 0.5668, 0.5851, 0.5581, 0.547, 0.5084, 0.5541, 0.5332, 0.5151, 0.5109]
make_plot(bs, loss, "Batch Size", "Loss", ["Test"], 1, "Batch-Size Plot")
make_plot(bs, acc, "Batch Size", "Accuracy", ["Test"], 1, "Batch-Size Plot")

#Batch size = 1
bs = [1,2,3,4,5,6,7,8,9,10]
acc = [0.34488000000000002, 0.39817999999999998, 0.40844000000000003, 0.40917999999999999, 0.42102000000000001, 0.42464000000000002, 0.42126000000000002, 0.42653999999999997, 0.42098000000000002, 0.42818000000000001]
val_acc = [0.3891, 0.39179999999999998, 0.41820000000000002, 0.43969999999999998, 0.37559999999999999, 0.42220000000000002, 0.40679999999999999, 0.41880000000000001, 0.43490000000000001, 0.42420000000000002]
loss = [1.7907269758780333, 1.6719095078816015, 1.6544571597637885, 1.6642851876294644, 1.6481633854401685, 1.6441352956283382, 1.6536684284817502, 1.6537091155248747, 1.6561231514425523, 1.6606833762412201]
val_loss = [1.6531876171393931, 1.6841191369744004, 1.6537310156859464, 1.5810074615753988, 1.7924938530453578, 1.6432255977710968, 1.7017293744867048, 1.696536216031705, 1.6248498681559185, 1.6654091223700775]
make_plot2(bs, loss, val_loss, "Epochs", "Loss", ["Train", "Test"], 1, "For Batch size 1")
make_plot2(bs, acc, val_acc, "Epochs", "Accuracy", ["Train", "Test"], 1, "For Batch Size 1")


##################################################################################################################################
#conv filters
##################################################################################################################################
x = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
loss = [1.28709056282, 1.18796640368, 1.17097667236, 1.15808616943, 1.13138168869, 1.07623703918, 1.05206326962, 1.01422518234, 1.04458297863, 1.03743890839, 1.05637641916]
acc = [0.5377, 0.5815, 0.5887, 0.5909, 0.6041, 0.6224, 0.6334, 0.6488, 0.6337, 0.6366, 0.6333]
make_plot(bs, loss, "Conv Filters", "Loss", ["Test"], 1, "Conv Filters Plot")
make_plot(bs, acc, "Conv Filters", "Accuracy", ["Test"], 1, "Conv Filters Plot")

##################################################################################################################################
#Layers
##################################################################################################################################
x = [1, 2, 3, 4, 5, 6, 7]
loss = [1.16805131721, 1.22554183712, 1.14558620901, 1.2294278017, 1.2114558424, 1.22075326633, 1.22515329723]
acc = [0.5892, 0.5768, 0.5944, 0.5686, 0.5742, 0.563, 0.5646]
make_plot(bs, loss, "No. of layers increased", "Loss", ["Test"], 1, "No. of layers Plot")
make_plot(bs, acc, "No. of layers increased", "Accuracy", ["Test"], 1, "No. of layers Plot")
